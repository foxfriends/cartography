import{f as W,a as E}from"./DTjTDYf3.js";import{M as I,aY as N,G as q,aZ as P,v as R,_ as w,p as Z,ah as Y,f as B,g as r,ag as U,X as J,Y as K,Z as Q,ad as L,s as A,a as V,c}from"./Cy0nnqwK.js";import{d as $,e as X}from"./wnUvJIYz.js";import{s as tt}from"./VCyrUZ76.js";import{i as et}from"./BxqNGrrm.js";import{s as rt,a as at}from"./DTiiyNL4.js";import{s as O}from"./Ni3ygk_w.js";import{p as it}from"./IrKOPqpB.js";const ot=()=>performance.now(),h={tick:e=>requestAnimationFrame(e),now:()=>ot(),tasks:new Set};function z(){const e=h.now();h.tasks.forEach(t=>{t.c(e)||(h.tasks.delete(t),t.f())}),h.tasks.size!==0&&h.tick(z)}function nt(e){let t;return h.tasks.size===0&&h.tick(z),{promise:new Promise(a=>{h.tasks.add(t={c:e,f:a})}),abort(){h.tasks.delete(t)}}}function j(e,t){q(()=>{e.dispatchEvent(new CustomEvent(t))})}function st(e){if(e==="float")return"cssFloat";if(e==="offset")return"cssOffset";if(e.startsWith("--"))return e;const t=e.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(a=>a[0].toUpperCase()+a.slice(1)).join("")}function ct(e){const t={},a=e.split(";");for(const i of a){const[s,o]=i.split(":");if(!s||o===void 0)break;const u=st(s.trim());t[u]=o.trim()}return t}const ut=e=>e;function ft(e,t,a,i){var s=(e&N)!==0,o="out",u,v=t.inert;t.style.overflow;var p,l;function y(){return q(()=>u??=a()(t,i?.()??{},{direction:o}))}var b={is_global:s,in(){t.inert=v;{l?.abort(),l?.reset?.();return}},out(f){t.inert=!0,j(t,"outrostart"),l=F(t,y(),p,0,()=>{j(t,"outroend"),f?.()})},stop:()=>{l?.abort()}},_=I;(_.nodes.t??=[]).push(b)}function F(e,t,a,i,s){if(P(t)){var o,u=!1;return R(()=>{if(!u){var k=t({direction:"out"});o=F(e,k,a,i,s)}}),{abort:()=>{u=!0,o?.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(!t?.duration)return s(),{abort:w,deactivate:w,reset:w,t:()=>i};const{delay:v=0,css:p,tick:l,easing:y=ut}=t;var b=[],_=()=>1-i,f=e.animate(b,{duration:v,fill:"forwards"});return f.onfinish=()=>{f.cancel();var k=1-i,x=i-k,m=t.duration*Math.abs(x),M=[];if(m>0){var C=!1;if(p)for(var D=Math.ceil(m/16.666666666666668),d=0;d<=D;d+=1){var T=k+x*y(d/D),G=ct(p(T,1-T));M.push(G),C||=G.overflow==="hidden"}C&&(e.style.overflow="hidden"),_=()=>{var n=f.currentTime;return k+x*y(n/m)},l&&nt(()=>{if(f.playState!=="running")return!1;var n=_();return l(n,1-n),!0})}f=e.animate(M,{duration:m,fill:"forwards"}),f.onfinish=()=>{_=()=>i,l?.(i,1-i),s()}},{abort:()=>{f&&(f.cancel(),f.effect=null,f.onfinish=w)},deactivate:()=>{s=w},reset:()=>{l?.(1,0)},t:()=>_()}}const dt=e=>e;function lt(e,{delay:t=0,duration:a=400,easing:i=dt}={}){const s=+getComputedStyle(e).opacity;return{delay:t,duration:a,easing:i,css:o=>`opacity: ${o*s}`}}var vt=W('<div class="griditem shadow svelte-1docm9i"></div>'),mt=W('<!> <div role="presentation"><!></div>',1);function Mt(e,t){Z(t,!0);const a=it(t,"loose",3,!1);let i=A(!1),s=A(null),o=A(0),u=A(0),v=A(!1);const p=Math.sign(Math.random()-.5)*(Math.round(Math.random()*10)+5);function l(n){c(v,!0),t.onMove&&c(i,!0)}function y(n){n.button===0&&r(i)&&(c(i,!1),t.onMove?.(r(o),r(u)),c(o,0),c(u,0))}function b(n){r(i)&&(c(v,!1),c(o,r(o)+n.movementX),c(u,r(u)+n.movementY))}function _(n){r(s)===null&&n.changedTouches.length===1&&(c(v,!1),t.onMove&&c(s,n.changedTouches[0],!0)),n.stopPropagation()}function f(n){r(s)&&!Array.from(n.touches).some(g=>g.identifier===r(s).identifier)&&(c(s,null),t.onMove?.(r(o),r(u)),c(o,0),c(u,0))}function k(n){if(r(s)===null)return;c(v,!1);const g=r(s),S=Array.from(n.touches).find(H=>H.identifier===g.identifier);S&&(c(o,r(o)+(S.clientX-g.clientX)),c(u,r(u)+(S.clientY-g.clientY)),c(s,S,!0))}function x(){r(v)&&t.onClick&&t.onClick()}const m=U(()=>r(i)||r(s));var M=mt();X("mouseup",Y,y),X("mousemove",Y,b),X("touchmove",Y,k,void 0,!0),X("touchend",Y,f),X("touchcancel",Y,f);var C=B(M);{var D=n=>{var g=vt();L(()=>O(g,`--grid-x: ${t.x??""}; --grid-y: ${t.y??""};`)),ft(2,g,()=>lt,()=>({duration:50})),E(n,g)};et(C,n=>{r(m)&&!a()&&n(D)})}var d=J(C,2);let T;d.__click=x,d.__mousedown=l,d.__touchstart=_;var G=K(d);tt(G,()=>t.children??w),Q(d),L(()=>{T=rt(d,1,"griditem tile svelte-1docm9i",null,T,{loose:a(),dragging:r(m),clickable:!!t.onClick,draggable:!!t.onMove}),at(d,"aria-grabbed",!!r(m)),O(d,`
    --loose-x: ${(a()?t.x:0)??""}px;
    --loose-y: ${(a()?t.y:0)??""}px;
    --grid-x: ${(a()?0:t.x)??""};
    --grid-y: ${(a()?0:t.y)??""};
    --drag-x: ${r(o)??""}px;
    --drag-y: ${r(u)??""}px;
    --loose-rotation: ${a()&&!r(m)?p:0}deg;
  `)}),E(e,M),V()}$(["click","mousedown","touchstart"]);var gt=W('<div class="gridlines svelte-2yd5bj"></div>');function Ct(e,t){var a=gt();let i;L(()=>i=O(a,"",i,{"--tile-width":t.tileWidth!==void 0?`${t.tileWidth}px`:void 0,"--tile-height":t.tileHeight!==void 0?`${t.tileHeight}px`:void 0})),E(e,a)}export{Mt as D,Ct as G};
