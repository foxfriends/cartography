import{c as me,a as f,f as $,d as mt,t as xe}from"../chunks/DTjTDYf3.js";import"../chunks/Dwwks_Q7.js";import{p as oe,ae as He,f as Y,a as re,c as P,s as F,g as e,af as Ze,a3 as _e,k as lt,d as Xe,ah as ve,ag as g,Y as v,Z as s,ad as Q,X as r,_ as ce,a$ as ut,aF as B}from"../chunks/Cy0nnqwK.js";import{s as be}from"../chunks/VCyrUZ76.js";import{e as ie,d as Se}from"../chunks/wnUvJIYz.js";import{s as vt,c as pe,r as We,R as ue,l as tt,a as ot,b as Ue,C as _t,d as wt,S as Je,e as bt,G as kt,f as rt,T as xt}from"../chunks/CvUAJ54q.js";import{i as de}from"../chunks/BxqNGrrm.js";import{e as Pe,s as Qe,a as we,i as Pt}from"../chunks/DTiiyNL4.js";import{s as qe,c as St}from"../chunks/Ni3ygk_w.js";import{s as te}from"../chunks/Zp7FgOxX.js";import{p as pt}from"../chunks/IrKOPqpB.js";import{D as Tt,G as Mt}from"../chunks/B5ZTdtgC.js";import{b as at,D as Et}from"../chunks/CFNKoBvp.js";import{b as N}from"../chunks/DIcbJqE8.js";const ht=Symbol("APP_STATE");function Ve(){return Ze(ht)}function $t(l,t){oe(t,!0);let a=F("place");He(ht,{get mode(){return e(a)},set mode(d){P(a,d,!0)}});var p=me(),c=Y(p);be(c,()=>t.children),f(l,p),re()}class Oe extends Event{cards;constructor(t){super("cardsreceived"),this.cards=t}}function It(){return window.crypto.randomUUID()}function Ct(l,t){const{name:a}=vt[t];return{id:It(),homeCard:l,species:t,name:a}}function zt({card:l,field:t},a){return l.source.some(p=>{switch(p.type){case"terrain":if(a.terrain[t.y]?.[t.x]?.type===p.terrain)return!0;break;case"any":return!0}})}function Rt(l){return l.category==="source"||l.category==="production"}function Me(){return window.crypto.randomUUID()}function nt(l){if(l.length===0)throw new TypeError("Cannot choose from an empty array");return l[Math.floor(Math.random()*l.length)]}const ft=Symbol("GAME_STATE");function Ie(){return Ze(ft)}function Dt(l,t){oe(t,!0);const a={biome:"Coast",origin:{x:0,y:0},terrain:[[{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"}],[{type:"grass"},{type:"grass"},{type:"grass"},{type:"soil"},{type:"soil"},{type:"grass"},{type:"grass"},{type:"grass"}],[{type:"grass"},{type:"grass"},{type:"soil"},{type:"soil"},{type:"soil"},{type:"grass"},{type:"grass"},{type:"grass"}],[{type:"grass"},{type:"grass"},{type:"soil"},{type:"soil"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"}],[{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"}],[{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"}],[{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"}],[{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"},{type:"grass"}]]};let p=F(_e([])),c=F(_e([])),d=F(_e([])),h=F(_e([])),y=F(_e({packs:[]})),x=F(_e([])),m=F(0);lt(()=>{const M=window.localStorage.getItem("game_state");if(M)try{(w=>{P(c,w.field,!0),P(p,w.deck,!0),P(x,w.flow,!0),P(d,w.citizens,!0),P(h,w.employment,!0),P(y,w.shop,!0),P(m,w.money,!0)})(JSON.parse(M))}catch{}}),He(ft,{get geography(){return a},get deck(){return e(p)},get field(){return e(c)},get shop(){return e(y)},get flow(){return e(x)},get citizens(){return e(d)},get employment(){return e(h)},get money(){return e(m)},set money(M){P(m,M,!0)}}),Xe(()=>{window.localStorage.setItem("game_state",JSON.stringify({field:e(c),deck:e(p),flow:e(x),citizens:e(d),employment:e(h),shop:e(y),money:e(m)}))});function _(M){for(const{id:w,type:E}of M.cards){const k=pe[E];if(k.category==="residential")for(const o of k.population)e(d).push(...Array.from({length:o.quantity},()=>Ct(w,o.species)))}e(p).push(...M.cards)}function z(M){if(M.pack.price>e(m))return;const w=Object.values(pe),E=M.pack.contents.map(k=>{switch(k.type){case"card":return k.missing?void 0:{id:Me(),type:k.card};case"category":return{id:Me(),type:nt(w.filter(o=>o.category===k.category)).type};case"any":return{id:Me(),type:nt(w).type}}}).filter(k=>k!==void 0);P(m,e(m)-M.pack.price),window.dispatchEvent(new Oe(E))}function C(M){if(M.flow.source===M.flow.destination)return;const w=e(p).find(u=>u.id===M.flow.source);if(!w)return;const E=pe[w.type];if(!("outputs"in E)||!E.outputs.some(u=>u.resource===M.flow.resource))return;const k=e(p).find(u=>u.id===M.flow.destination);if(!k)return;const o=pe[k.type];"inputs"in o&&o.inputs.some(u=>u.resource===M.flow.resource)&&(e(x).some(u=>u.source===M.flow.source&&u.destination===M.flow.destination&&u.resource===M.flow.resource)||e(x).push(M.flow))}function T(M){const w=e(x).findIndex(E=>E.id===M.flow);w!==-1&&e(x).splice(w,1)}var R=me();ie("cardsreceived",ve,_),ie("buypack",ve,z),ie("createflow",ve,C),ie("deleteflow",ve,T);var O=Y(R);be(O,()=>t.children),f(l,R),re()}function Ft(l){return new Map(l.map(t=>[t.id,t]))}function Ot(l){return new Map(l.map(t=>[t.id,t]))}function qt(){return window.crypto.randomUUID()}function At(l){return Map.groupBy(l,t=>t.destination)}function Le(l,t){return l+t}const gt=Symbol("RESOURCE_STATE");function Ke(){return Ze(gt)}function Gt(l,t){oe(t,!0);const a=Ie(),p=g(()=>a.deck),c=g(()=>a.field),d=g(()=>a.flow),h=g(()=>a.geography),y=g(()=>Ft(e(p))),x=g(()=>Ot(e(c))),m=g(()=>At(e(d))),_=g(()=>e(c).filter(w=>!w.loose)),z=g(()=>e(_).map(w=>e(y).get(w.id)).map(w=>pe[w.type]).filter(w=>w.category==="residential").flatMap(w=>w.population).reduce((w,E)=>(w[E.species]??={quantity:0},w[E.species].quantity+=E.quantity,w),{})),C=g(()=>{const w={},E=new Map(Array.from(e(m).entries()).filter(([,o])=>o.length).map(([o,u])=>[o,[...u]])),k=e(_).filter(o=>Rt(pe[e(y).get(o.id).type])).filter(o=>!e(m).get(o.id)?.length).map(o=>o.id);e:for(;k.length;){const o=k.shift(),u=e(x).get(o),I=e(y).get(o),S=pe[I.type];for(const[D,X]of E.entries()){const j=X.filter(Z=>Z.source===o);j.length?E.set(D,j):(E.delete(D),k.push(D))}const q=[];switch(S.category){case"production":{const D=e(m).get(o),X=S.inputs.map(j=>{const Z=[];let W=j.quantity;if(D)for(const L of D){const J=w[L.source]?.outputs;if(J)for(const V of J){if(V.resource!==j.resource)continue;const le=V.quantity-V.consumedBy.map(ge=>ge.quantity).reduce(Le,0);if(W<=le){Z.push({flow:L,output:V,quantity:W}),W=0;break}else Z.push({flow:L,output:V,quantity:le}),W-=le}}return{input:j,remaining:W,consumeFrom:Z}});if(!X.every(j=>j.remaining===0))continue e;for(const j of X)for(const{flow:Z,output:W,quantity:L}of j.consumeFrom)W.consumedBy.push({id:o,quantity:L}),q.push({cardId:Z.source,resource:W.resource,quantity:L});break}case"source":{if(!zt({card:S,field:u},e(h)))continue e;break}case"residential":case"trade":continue e;default:throw new Error("Unreachable")}w[o]={inputs:q,outputs:S.outputs.map(D=>({...D,consumedBy:[]}))}}return w}),T=g(()=>{const w=Object.values(e(C)).flatMap(E=>E.outputs).reduce((E,k)=>{E[k.resource]??={produced:0,consumed:0,demand:0},E[k.resource].produced+=k.quantity;for(const{quantity:o}of k.consumedBy)E[k.resource].consumed+=o;return E},{});for(const[E,{quantity:k}]of Object.entries(e(z)))for(const o of vt[E].needs)o.type==="resource"&&(w[o.resource]??={produced:0,consumed:0,demand:0},w[o.resource].demand+=k*o.quantity);return w}),R=g(()=>Object.entries(e(T)).map(([w,{produced:E,consumed:k,demand:o}])=>{const u=We[w].value;return u*Math.max(0,E-k-o)+u*5*Math.min(o,Math.max(0,E-k))}).reduce(Le,0));He(gt,{get population(){return e(z)},get cardProduction(){return e(C)},get resourceProduction(){return e(T)},get income(){return e(R)}});var O=me(),M=Y(O);be(M,()=>t.children),f(l,O),re()}class Bt extends Event{cardId;constructor(t){super("cardfocus"),this.cardId=t}}var jt=$('<div class="card svelte-isv3d4"> </div>');function Yt(l,t){oe(t,!0);const a=pt(t,"loose",3,!1),p=Ve();function c(){window.dispatchEvent(new Bt(t.id))}const d=g(()=>pe[t.type].name.split(" ").map(h=>h[0]).join(""));{let h=g(()=>p.mode==="place"?t.onMove:void 0);Tt(l,{get onMove(){return e(h)},onClick:c,get x(){return t.x},get y(){return t.y},get loose(){return a()},children:(y,x)=>{var m=jt(),_=v(m,!0);s(m),Q(()=>te(_,e(d))),f(y,m)},$$slots:{default:!0}})}re()}function Xt(l,t){oe(t,!0);var a=me(),p=Y(a);Pe(p,17,()=>t.field,c=>c.id,(c,d)=>{const h=g(()=>t.deck.find(_=>_.id===e(d).id));var y=me(),x=Y(y);{var m=_=>{Yt(_,{get id(){return e(d).id},get x(){return e(d).x},get y(){return e(d).y},get type(){return e(h).type},onMove:(z,C)=>t.onMoveCard(e(d).id,z,C),get loose(){return e(d).loose}})};de(x,_=>{e(h)&&_(m)})}f(c,y)}),f(l,a),re()}class Nt extends Event{card;constructor(t){super("cardplaced"),this.card=t}}class Ut extends Event{flow;constructor(t){super("createflow"),this.flow=t}}class Wt extends Event{flow;constructor(t){super("deleteflow"),this.flow=t}}var Lt=mt('<path role="button" tabindex="0"></path><defs><linearGradient><stop offset="0%" style="stop-color: color-mix(in oklch shorter hue, var(--color-output) 100%, var(--color-input) 0%)"></stop><stop offset="10%" style="stop-color: color-mix(in oklch shorter hue, var(--color-output) 90%, var(--color-input) 10%)"></stop><stop offset="20%" style="stop-color: color-mix(in oklch shorter hue, var(--color-output) 80%, var(--color-input) 20%)"></stop><stop offset="30%" style="stop-color: color-mix(in oklch shorter hue, var(--color-output) 70%, var(--color-input) 30%)"></stop><stop offset="40%" style="stop-color: color-mix(in oklch shorter hue, var(--color-output) 60%, var(--color-input) 40%)"></stop><stop offset="50%" style="stop-color: color-mix(in oklch shorter hue, var(--color-output) 50%, var(--color-input) 50%)"></stop><stop offset="60%" style="stop-color: color-mix(in oklch shorter hue, var(--color-output) 40%, var(--color-input) 60%)"></stop><stop offset="70%" style="stop-color: color-mix(in oklch shorter hue, var(--color-output) 30%, var(--color-input) 70%)"></stop><stop offset="80%" style="stop-color: color-mix(in oklch shorter hue, var(--color-output) 20%, var(--color-input) 80%)"></stop><stop offset="90%" style="stop-color: color-mix(in oklch shorter hue, var(--color-output) 10%, var(--color-input) 90%)"></stop><stop offset="100%" style="stop-color: color-mix(in oklch shorter hue, var(--color-output) 0%, var(--color-input) 100%)"></stop></linearGradient></defs>',1);function st(l,t){const d=g(()=>`${t.x1}_${t.y1}_${t.x2}_${t.y2}`),h=g(()=>t.x2-t.x1),y=g(()=>t.y2-t.y1),x=g(()=>Math.sqrt(e(h)**2+e(y)**2)),m=g(()=>e(x)/2),_=g(()=>Math.atan2(e(y),e(h))),z=g(()=>Math.sign(e(h))),C=g(()=>Math.sign(e(y))),T=g(()=>Math.sign(e(h))||1),R=g(()=>t.x1+e(h)/2+e(m)*Math.sin(e(_))/2*e(T)),O=g(()=>t.y1+e(y)/2-e(m)*Math.cos(e(_))/2*e(T)),M=g(()=>t.x1+e(h)/2+(e(m)+12)*Math.sin(e(_))/2*e(T)),w=g(()=>t.y1+e(y)/2-(e(m)+12)*Math.cos(e(_))/2*e(T)),E=g(()=>1-Math.max(0,Math.min(1,(e(x)-256)/384)*.75));var k=Lt(),o=Y(k);o.__click=function(...q){t.onclick?.apply(this,q)};let u;var I=r(o),S=v(I);s(I),Q(()=>{u=Qe(o,0,"flow live svelte-da3do8",null,u,{selectable:!!t.onclick}),qe(o,`--efficacy: ${e(E)??""}; fill: url(#${e(d)??""}); stroke: url(#${e(d)??""})`),we(o,"d",`M ${t.x1??""} ${t.y1??""} Q ${e(R)??""} ${e(O)??""} ${t.x2??""} ${t.y2??""} Q ${e(M)??""} ${e(w)??""} ${t.x1??""} ${t.y1??""}`),we(S,"id",e(d)),we(S,"x1",e(z)===-1?1:0),we(S,"y1",e(C)===-1?1:0),we(S,"x2",e(z)===-1?0:1),we(S,"y2",e(C)===-1?0:1)}),f(l,k)}Se(["click"]);class it extends Event{sourceType;resource;clientX;clientY;constructor({resource:t,sourceType:a,clientX:p,clientY:c}){super("startflow"),this.sourceType=a,this.resource=t,this.clientX=p,this.clientY=c}}var Ht=$('<div class="piprow svelte-go3dgf"><div class="pip input svelte-go3dgf" role="presentation"></div> <span> <!></span></div>'),Zt=$('<div class="pips svelte-go3dgf"></div>'),Jt=$('<div class="piprow svelte-go3dgf"><span><!> </span> <div class="pip output svelte-go3dgf" role="presentation"></div></div>'),Qt=$('<div class="pips svelte-go3dgf"></div>'),Vt=$('<div class="gridspace svelte-go3dgf"><!> <!></div>');function Kt(l,t){oe(t,!0);const a=g(()=>pe[t.type]),p=_e({}),c=_e({});function d(T){return p[T]}function h(T){return c[T]}var y={findInput:d,findOutput:h},x=Vt(),m=v(x);{var _=T=>{var R=Zt();Pe(R,21,()=>e(a).inputs,O=>O.resource,(O,M)=>{var w=Ht(),E=v(w),k=g(()=>tt(ot(S=>new it({resource:e(M).resource,sourceType:"input",clientX:S.clientX,clientY:S.clientY}))));E.__mousedown=function(...S){e(k)?.apply(this,S)},N(E,(S,q)=>p[q.resource]=S,S=>p?.[S.resource],()=>[e(M)]);var o=r(E,2),u=v(o),I=r(u);ue(I,{get id(){return e(M).resource}}),s(o),s(w),Q(()=>te(u,`${e(M).quantity??""} → `)),ie("startflow",E,function(...S){t.onStartFlow?.apply(this,S)}),f(O,w)}),s(R),f(T,R)};de(m,T=>{"inputs"in e(a)&&T(_)})}var z=r(m,2);{var C=T=>{var R=Qt();Pe(R,21,()=>e(a).outputs,O=>O.resource,(O,M)=>{var w=Jt(),E=v(w),k=v(E);ue(k,{get id(){return e(M).resource}});var o=r(k);s(E);var u=r(E,2),I=g(()=>tt(ot(S=>new it({resource:e(M).resource,sourceType:"output",clientX:S.clientX,clientY:S.clientY}))));u.__mousedown=function(...S){e(I)?.apply(this,S)},N(u,(S,q)=>c[q.resource]=S,S=>c?.[S.resource],()=>[e(M)]),s(w),Q(()=>te(o,` → ${e(M).quantity??""}`)),ie("startflow",u,function(...S){t.onStartFlow?.apply(this,S)}),f(O,w)}),s(R),f(T,R)};de(z,T=>{"outputs"in e(a)&&T(C)})}return s(x),Q(()=>{qe(x,`--grid-x: ${t.x??""}; --grid-y: ${t.y??""}`),we(x,"data-cardid",t.id)}),f(l,x),re(y)}Se(["mousedown"]);var eo=$('<!> <div class="full svelte-13qno0"><svg><!><!></svg></div>',1);function to(l,t){oe(t,!0);const a=g(()=>t.flow.map(({source:o,destination:u,...I})=>{const S=t.field.find(D=>D.id===o),q=t.field.find(D=>D.id===u);if(!(!S||!q))return{...I,source:S,destination:q}}).filter(o=>o!==void 0).toSorted((o,u)=>o.priority-u.priority));let p=F(0),c=F(0),d=F(void 0),h=F(0),y=F(0);const x=_e({});function m(o,u){P(d,{resource:o.resource,sourceType:o.sourceType,anchor:o.currentTarget,card:u},!0),P(h,o.clientX,!0),P(y,o.clientY,!0)}function _(o){e(d)&&(P(h,o.clientX,!0),P(y,o.clientY,!0))}function z(o){if(o.button===0&&e(d)){const u=document.elementFromPoint(e(h),e(y))?.closest("[data-cardid]");if(u){const I=u.dataset.cardid;window.dispatchEvent(new Ut({id:qt(),priority:0,source:e(d).sourceType==="output"?e(d).card.id:I,destination:e(d).sourceType==="output"?I:e(d).card.id,resource:e(d).resource}))}P(h,0),P(y,0),P(d,void 0)}}function C(o){window.dispatchEvent(new Wt(o))}var T=eo();ie("mousemove",ve,_),ie("mouseup",ve,z);var R=Y(T);Pe(R,17,()=>t.field,o=>o.id,(o,u)=>{const I=g(()=>t.deck.find(S=>S.id===e(u).id));N(Kt(o,{get id(){return e(u).id},get type(){return e(I).type},get x(){return e(u).x},get y(){return e(u).y},onStartFlow:S=>m(S,e(u))}),(S,q)=>x[q.id]=S,S=>x?.[S.id],()=>[e(u)])});var O=r(R,2),M=v(O),w=v(M);Pe(w,17,()=>e(a),o=>o.id,(o,u,I,S)=>{const q=g(()=>x[e(u).source.id]?.findOutput(e(u).resource)?.getBoundingClientRect()),D=g(()=>x[e(u).destination.id]?.findInput(e(u).resource)?.getBoundingClientRect());var X=me(),j=Y(X);{var Z=W=>{{let L=g(()=>e(q).x+e(q).width/2),J=g(()=>e(q).y+e(q).height/2),V=g(()=>e(D).x+e(D).width/2),le=g(()=>e(D).y+e(D).height/2);st(W,{get x1(){return e(L)},get y1(){return e(J)},get x2(){return e(V)},get y2(){return e(le)},onclick:()=>C(e(u).id)})}};de(j,W=>{e(q)&&e(D)&&W(Z)})}f(o,X)});var E=r(w);{var k=o=>{const u=g(()=>e(d).anchor.getBoundingClientRect()),I=g(()=>e(u).x+e(u).width/2),S=g(()=>e(u).y+e(u).height/2);st(o,{get x1(){return e(I)},get y1(){return e(S)},get x2(){return e(h)},get y2(){return e(y)}})};de(E,o=>{e(d)&&o(k)})}s(M),s(O),Q(()=>we(M,"viewBox",`0 0 ${e(c)??""} ${e(p)??""}`)),at(O,"clientWidth",o=>P(c,o)),at(O,"clientHeight",o=>P(p,o)),f(l,T),re()}var oo=$('<div class="terrain svelte-11xczzg"></div>'),ro=$("<!> <!> <!> <!>",1);function ao(l,t){oe(t,!0);const a=128,p=Ve(),c=Ie(),d=g(()=>c.geography),h=g(()=>c.deck),y=g(()=>c.field),x=g(()=>c.flow);let m=F(0),_=F(0),z=F(0),C=F(0);function T(I,S,q){const D=e(y).find(X=>X.id===I);if(D){const X=D.loose?Math.round((D.x+S)/a):D.x+Math.round(S/a),j=D.loose?Math.round((D.y+q)/a):D.y+Math.round(q/a);if(e(y).some(Z=>Z.x===X&&Z.y===j))return;D.x=X,D.y=j,D.loose=!1,window.dispatchEvent(new Nt(D))}}const R=g(()=>Math.floor(e(z)/a)),O=g(()=>Math.floor(e(C)/a)),M=g(()=>Math.floor((e(z)+e(m))/a)+1),w=g(()=>Math.floor((e(C)+e(_))/a)+1);function E({x:I,y:S}){return e(m)===0||e(_)===0?!1:e(R)<=I&&I<e(M)&&e(O)<=S&&S<e(w)}const k=g(()=>e(d).terrain.slice(Math.max(0,e(O)-e(d).origin.y),Math.max(0,e(w)-e(d).origin.y)).flatMap((I,S)=>I.slice(Math.max(0,e(R)-e(d).origin.x),Math.max(0,e(M)-e(d).origin.x)).map((q,D)=>({x:D+Math.max(e(R)-e(d).origin.x,0),y:S+Math.max(e(O)-e(d).origin.y,0),...q})))),o=g(()=>e(y).filter(I=>I.loose||E(I))),u=g(()=>e(o).filter(I=>!I.loose));Et(l,{get offsetX(){return e(z)},set offsetX(I){P(z,I,!0)},get offsetY(){return e(C)},set offsetY(I){P(C,I,!0)},get clientWidth(){return e(m)},set clientWidth(I){P(m,I,!0)},get clientHeight(){return e(_)},set clientHeight(I){P(_,I,!0)},children:(I,S)=>{var q=ro(),D=Y(q);Pe(D,16,()=>e(k),L=>L,(L,J)=>{var V=oo();Q(()=>{we(V,"data-type",J.type),qe(V,`--grid-x: ${J.x??""}; --grid-y: ${J.y??""}`)}),f(L,V)});var X=r(D,2);Mt(X,{});var j=r(X,2);Xt(j,{get field(){return e(o)},get deck(){return e(h)},onMoveCard:T});var Z=r(j,2);{var W=L=>{to(L,{get field(){return e(u)},get deck(){return e(h)},get flow(){return e(x)}})};de(Z,L=>{p.mode==="flow"&&L(W)})}f(I,q)},$$slots:{default:!0}}),re()}class no extends Event{card;constructor(t){super("cardfielded"),this.card=t}}var so=$('<dialog class="svelte-1ylobv7"><!></dialog>');function io(l,t){oe(t,!0);let a=F(void 0),p=F(void 0);function c(_){P(p,_,!0),e(a)?.show()}function d(){e(a)?.close()}var h={show:c,close:d},y=so();ie("click",ve,d);var x=v(y);{var m=_=>{Ue(_,{get card(){return e(p)}})};de(x,_=>{e(p)&&_(m)})}return s(y),N(y,_=>P(a,_),()=>e(a)),f(l,y),re(h)}var co=$('<div class="row svelte-15gpl1s"></div>');function yt(l,t){var a=co();Pe(a,21,()=>t.items,Pt,(p,c)=>{var d=me(),h=Y(d);be(h,()=>t.item,()=>e(c)),f(p,d)}),s(a),f(l,a)}var lo=$('<dialog class="svelte-eun80g"><!></dialog>');function uo(l,t){oe(t,!0);let a=F(void 0);function p(){e(a)?.showModal()}function c(){e(a)?.close()}var d={show:p,close:c},h=lo(),y=v(h);return be(y,()=>t.children),s(h),N(h,x=>P(a,x),()=>e(a)),Q(()=>qe(h,t.style)),f(l,h),re(d)}var vo=$('<div class="card svelte-t8l7ck"><!></div>'),po=$('<article class="svelte-t8l7ck"><header class="svelte-t8l7ck"><h1>Card Received!</h1></header> <!> <button>Sweet!</button></article>');function ho(l,t){oe(t,!0);let a=F(void 0),p=F(_e([]));function c(h){P(p,h,!0),e(a)?.show()}var d={show:c};return N(uo(l,{style:"--shimmer-color: rgb(164 85 217)",children:(h,y)=>{var x=po(),m=r(v(x),2);yt(m,{get items(){return e(p)},item:(C,T=ce)=>{var R=vo(),O=v(R);Ue(O,{get card(){return T()}}),s(R),f(C,R)}});var _=r(m,2);_.__click=()=>e(a)?.close(),s(x),f(h,x)},$$slots:{default:!0}}),h=>P(a,h,!0),()=>e(a)),re(d)}Se(["click"]);var fo=$("<dialog><!></dialog>");function et(l,t){oe(t,!0);const a=pt(t,"sizing",3,"fit");let p=F(void 0);function c(){e(p)?.showModal()}function d(){e(p)?.close()}var h={show:c,close:d},y=fo(),x=v(y);return be(x,()=>t.children),s(y),N(y,m=>P(p,m),()=>e(p)),Q(()=>Qe(y,1,St(a()),"svelte-ta60gp")),f(l,y),re(h)}class go extends Event{constructor(){super("deckopened")}}var yo=$('<article><header class="svelte-rkzgio"><h1>Deck</h1> <button class="close svelte-rkzgio">&times;</button></header> <div class="content svelte-rkzgio"><!></div></article>');function mo(l,t){oe(t,!0);const a=Ie(),p=g(()=>a.deck),c=g(()=>a.field),d=g(()=>e(p).map(_=>({...pe[_.type],deckCard:_,isFielded:e(c).some(z=>z.id===_.id)})));let h=F(void 0);function y(){e(h)?.show(),window.dispatchEvent(new go)}function x(){e(h)?.close()}var m={show:y,close:x};return N(et(l,{sizing:"fill",children:(_,z)=>{var C=yo(),T=v(C),R=r(v(T),2);R.__click=()=>e(h).close(),s(T);var O=r(T,2),M=v(O);_t(M,{get cards(){return e(d)},card:(E,k=ce)=>{{let o=g(()=>wt(k())(t.onSelectCard));Ue(E,{get card(){return k()},get onSelect(){return e(o)},get disabled(){return k().isFielded}})}}}),s(O),s(C),f(_,C)},$$slots:{default:!0}}),_=>P(h,_,!0),()=>e(h)),re(m)}Se(["click"]);function Ee(l,t){Je(l,{style:"--shimmer-color: oklch(from var(--color-money) calc(l - 0.2) c h)",children:(a,p)=>{var c=me(),d=Y(c);{var h=x=>{var m=xe();Q(()=>te(m,`$${t.amount??""}`)),f(x,m)},y=x=>{var m=xe("Money");f(x,m)};de(d,x=>{t.amount!==void 0?x(h):x(y,!1)})}f(a,c)}})}var _o=$('<tr class="svelte-mterps"><th class="svelte-mterps"><!></th><td class="produced svelte-mterps"> </td><td class="consumed svelte-mterps"> </td><td class="svelte-mterps"><span class="produced svelte-mterps"> </span> / <span class="consumed svelte-mterps"> </span></td><td class="consumed svelte-mterps"> </td><td class="svelte-mterps"><!></td><td class="svelte-mterps"><!></td></tr>'),wo=$('<table class="svelte-mterps"><thead class="svelte-mterps"><tr class="svelte-mterps"><th class="svelte-mterps">Resource</th><th class="svelte-mterps">Produced</th><th class="svelte-mterps">Consumed</th><th class="svelte-mterps">Satisfaction</th><th class="svelte-mterps">Exported</th><th class="svelte-mterps">Value</th><th class="svelte-mterps">Profit</th></tr></thead><tbody></tbody><tfoot class="svelte-mterps"><tr class="svelte-mterps"><th class="svelte-mterps">Total</th><td class="svelte-mterps"></td><td class="svelte-mterps"></td><td class="svelte-mterps"></td><td class="svelte-mterps"></td><td class="svelte-mterps"></td><td class="svelte-mterps"><!></td></tr></tfoot></table>');function bo(l,t){oe(t,!0);const a=g(()=>Object.entries(t.resourceProduction).map(([m,{produced:_,consumed:z,demand:C}])=>{const T=We[m].value;return T*Math.max(0,_-z-C)+T*5*Math.min(C,Math.max(0,_-z))}).reduce(Le,0));var p=wo(),c=r(v(p));Pe(c,21,()=>Object.entries(t.resourceProduction),([m,_])=>m,(m,_)=>{var z=g(()=>ut(e(_),2));let C=()=>e(z)[0],T=()=>e(z)[1];const R=g(()=>Math.max(0,T().produced-T().consumed-T().demand)),O=g(()=>Math.min(T().demand,Math.max(0,T().produced-T().consumed))),M=g(()=>We[C()].value);var w=_o(),E=v(w),k=v(E);ue(k,{get id(){return C()}}),s(E);var o=r(E),u=v(o,!0);s(o);var I=r(o),S=v(I,!0);s(I);var q=r(I),D=v(q),X=v(D,!0);s(D);var j=r(D,2),Z=v(j,!0);s(j),s(q);var W=r(q),L=v(W,!0);s(W);var J=r(W),V=v(J);Ee(V,{get amount(){return e(M)}}),s(J);var le=r(J),ge=v(le);{let ye=g(()=>e(M)*e(R)+e(M)*5*e(O));Ee(ge,{get amount(){return e(ye)}})}s(le),s(w),Q(()=>{te(u,T().produced),te(S,T().consumed),te(X,e(O)),te(Z,T().demand),te(L,e(R))}),f(m,w)}),s(c);var d=r(c),h=v(d),y=r(v(h),6),x=v(y);Ee(x,{get amount(){return e(a)}}),s(y),s(h),s(d),s(p),f(l,p),re()}var ko=$('<article><header class="svelte-1dvzbw0"><h1>Production Report</h1> <button class="close svelte-1dvzbw0">&times;</button></header> <div class="content svelte-1dvzbw0"><!></div></article>');function xo(l,t){oe(t,!0);const a=Ke(),p=g(()=>a.resourceProduction);let c=F(void 0);function d(){e(c)?.show()}function h(){e(c)?.close()}var y={show:d,close:h};return N(et(l,{children:(x,m)=>{var _=ko(),z=v(_),C=r(v(z),2);C.__click=()=>e(c).close(),s(z);var T=r(z,2),R=v(T);bo(R,{get resourceProduction(){return e(p)}}),s(T),s(_),f(x,_)},$$slots:{default:!0}}),x=>P(c,x,!0),()=>e(c)),re(y)}Se(["click"]);class Po extends Event{constructor(){super("shopopened")}}var So=$('<div class="category svelte-legrwj"> </div>'),To=$('<div class="card-back svelte-legrwj"><!></div>');function ct(l,t){var a=To(),p=v(a);{var c=d=>{var h=So(),y=v(h,!0);s(h),Q(()=>te(y,t.category)),f(d,h)};de(p,d=>{t.category&&d(c)})}s(a),f(l,a)}function Ne(l,t){Je(l,{style:"--shimmer-color: var(--color-pack)",children:(a,p)=>{var c=me(),d=Y(c);be(d,()=>t.children),f(a,c)}})}var Mo=$('<div class="shimmer svelte-y2bo7g"><!></div>');function dt(l,t){var a=Mo(),p=v(a);be(p,()=>t.children??ce),s(a),Q(()=>qe(a,t.style)),f(l,a)}var Eo=$('<div class="info svelte-1h5lzcn"> </div>'),$o=$('<s class="price-label svelte-1h5lzcn"> </s>'),Io=$('<div class="price-tag replaced svelte-1h5lzcn"><!></div>'),Co=$('<div class="price-label svelte-1h5lzcn"> </div>'),zo=$('<div class="card svelte-1h5lzcn"><!></div>'),Ro=$('<div class="pack svelte-1h5lzcn" role="button"><div class="banner svelte-1h5lzcn"><!></div> <!> <!> <div><!></div></div> <dialog class="tooltip svelte-1h5lzcn"><header class="svelte-1h5lzcn"><!></header> <!></dialog>',1);function Do(l,t){oe(t,!0);let a=F(!1);var p=Ro(),c=Y(p);we(c,"tabindex",0),c.__click=function(...k){t.onSelect?.apply(this,k)};var d=g(()=>bt(t.onSelect));c.__keydown=function(...k){e(d)?.apply(this,k)},c.__mouseover=()=>P(a,!0),c.__mouseout=()=>P(a,!1);var h=v(c),y=v(h);Ne(y,{children:(k,o)=>{B();var u=xe();Q(()=>te(u,t.pack.name)),f(k,u)}}),s(h);var x=r(h,2);{var m=k=>{var o=Eo(),u=v(o,!0);s(o),Q(()=>te(u,t.pack.description)),f(k,o)};de(x,k=>{t.pack.description&&k(m)})}var _=r(x,2);{var z=k=>{var o=Io(),u=v(o);dt(u,{style:"--shimmer-color: oklch(from var(--color-money) l calc(c - 0.075) h); border-radius: 1rem; padding-inline: 1rem;",children:(I,S)=>{var q=$o(),D=v(q);s(q),Q(()=>te(D,`$${t.pack.originalPrice??""}`)),f(I,q)}}),s(o),f(k,o)};de(_,k=>{t.pack.originalPrice&&k(z)})}var C=r(_,2);let T;var R=v(C);dt(R,{style:"--shimmer-color: var(--color-money); border-radius: 1rem; padding-inline: 1rem;",children:(k,o)=>{var u=Co(),I=v(u);s(u),Q(()=>te(I,`$${t.pack.price??""}`)),f(k,u)}}),s(C),s(c);var O=r(c,2),M=v(O),w=v(M);Ne(w,{children:(k,o)=>{B();var u=xe();Q(()=>te(u,t.pack.name)),f(k,u)}}),s(M);var E=r(M,2);yt(E,{get items(){return t.pack.contents},item:(o,u=ce)=>{var I=zo(),S=v(I);{var q=X=>{Ue(X,{get card(){return pe[u().card]},get disabled(){return u().missing}})},D=X=>{var j=me(),Z=Y(j);{var W=J=>{ct(J,{get category(){return u().category}})},L=J=>{var V=me(),le=Y(V);{var ge=ye=>{ct(ye,{})};de(le,ye=>{u().type==="any"&&ye(ge)},!0)}f(J,V)};de(Z,J=>{u().type==="category"?J(W):J(L,!1)},!0)}f(X,j)};de(S,X=>{u().type==="card"?X(q):X(D,!1)})}s(I),f(o,I)}}),s(O),Q(()=>{T=Qe(C,1,"price-tag svelte-1h5lzcn",null,T,{replacement:!!t.pack.originalPrice}),O.open=e(a)}),ie("focus",c,()=>P(a,!0)),ie("blur",c,()=>P(a,!1)),f(l,p),re()}Se(["click","keydown","mouseover","mouseout"]);class Fo extends Event{pack;constructor(t){super("buypack"),this.pack=t}}var Oo=$('<article><header class="svelte-1w43591"><h1>Shop</h1> <button class="close svelte-1w43591">&times;</button></header> <div class="content svelte-1w43591"><!></div></article>');function qo(l,t){oe(t,!0);const a=Ie(),p=g(()=>a.shop);let c=F(void 0);function d(){e(c)?.show(),window.dispatchEvent(new Po)}function h(m){e(c)?.close(),window.dispatchEvent(new Fo(m))}function y(){e(c)?.close()}var x={show:d,close:y};return N(et(l,{sizing:"fill",children:(m,_)=>{var z=Oo(),C=v(z),T=r(v(C),2);T.__click=()=>e(c).close(),s(C);var R=r(C,2),O=v(R);kt(O,{get items(){return e(p).packs},item:(w,E=ce)=>{Do(w,{get pack(){return E()},onSelect:()=>h(E())})}}),s(R),s(z),f(m,z)},$$slots:{default:!0}}),m=>P(c,m,!0),()=>e(c)),re(x)}Se(["click"]);var Ao=$("<span><!> <!></span>"),Go=$('<button class="svelte-og50z2">Prod</button> <button class="svelte-og50z2">Shop</button>',1),Bo=$('<div class="area svelte-og50z2"><div class="status svelte-og50z2"><div class="title-area svelte-og50z2"><span class="title svelte-og50z2">Your Town</span> <span> </span> <span> </span></div> <div class="resource-area svelte-og50z2"></div></div> <div class="menu svelte-og50z2" role="toolbar"><a class="button svelte-og50z2" href="/">Menu</a> <button class="svelte-og50z2">Reset</button> <button class="svelte-og50z2"> </button> <!> <button class="svelte-og50z2">Deck</button></div></div> <!> <!> <!> <!> <!>',1);function jo(l,t){oe(t,!0);const a=Ve(),p=Ie(),c=g(()=>p.deck),d=g(()=>p.field),h=g(()=>p.money),y=Ke(),x=g(()=>y.resourceProduction),m=g(()=>y.income);let _=F(void 0),z=F(void 0),C=F(void 0),T=F(void 0),R=F(void 0);const O=g(()=>e(c).find(n=>n.type==="trading-centre")),M=g(()=>e(d).find(n=>n.id===e(O)?.id)),w=g(()=>e(M)&&!e(M).loose);function E(){e(_)?.show()}function k(){e(z)?.show()}function o(){a.mode=a.mode==="flow"?"place":"flow"}function u(){e(R)?.show()}function I(n){window.dispatchEvent(new no(n.deckCard)),e(d).push({id:n.deckCard.id,x:0,y:0,loose:!0}),e(_)?.close()}function S(){window.localStorage.clear(),window.location.reload()}function q(n){e(C)?.show(n.cards.map(b=>pe[b.type]))}function D(n){const b=e(c).find(H=>H.id===n.cardId);if(!b)return;const G=pe[b.type];window.setTimeout(()=>e(T)?.show(G),0)}var X=Bo();ie("cardsreceived",ve,q),ie("cardfocus",ve,D);var j=Y(X),Z=v(j),W=v(Z),L=r(v(W),2),J=v(L);s(L);var V=r(L,2),le=v(V);s(V),s(W);var ge=r(W,2);Pe(ge,21,()=>Object.entries(e(x)),([n,{produced:b,consumed:G,demand:H}])=>n,(n,b)=>{var G=g(()=>ut(e(b),2));let H=()=>e(G)[0],ne=()=>e(G)[1].produced,ae=()=>e(G)[1].consumed,se=()=>e(G)[1].demand;var ee=Ao(),he=v(ee);ue(he,{get id(){return H()}});var ke=r(he,2);{var De=Te=>{var Fe=xe();Q(()=>te(Fe,`${ne()??""}/${se()??""}`)),f(Te,Fe)},Ye=Te=>{var Fe=xe();Q(()=>te(Fe,ne()-ae())),f(Te,Fe)};de(ke,Te=>{se()?Te(De):Te(Ye,!1)})}s(ee),f(n,ee)}),s(ge),s(Z);var ye=r(Z,2),Ce=r(v(ye),2);Ce.__click=S;var $e=r(Ce,2);$e.__click=o;var Ae=v($e);s($e);var ze=r($e,2);{var Ge=n=>{var b=Go(),G=Y(b);G.__click=u;var H=r(G,2);H.__click=k,f(n,b)};de(ze,n=>{e(w)&&n(Ge)})}var Be=r(ze,2);Be.__click=E,s(ye),s(j);var Re=r(j,2);N(xo(Re,{}),n=>P(R,n,!0),()=>e(R));var je=r(Re,2);N(mo(je,{onSelectCard:I}),n=>P(_,n,!0),()=>e(_));var U=r(je,2);N(qo(U,{}),n=>P(z,n,!0),()=>e(z));var i=r(U,2);N(ho(i,{}),n=>P(C,n,!0),()=>e(C));var A=r(i,2);N(io(A,{}),n=>P(T,n,!0),()=>e(T)),Q(()=>{te(J,`$${e(h)??""}`),te(le,`$${e(m)??""} / day`),te(Ae,`Mode: ${a.mode??""}`)}),f(l,X),re()}Se(["click"]);function K(l,t){oe(t,!0);const a=g(()=>pe[t.id]);Je(l,{style:"--shimmer-color: var(--color-card)",children:(p,c)=>{B();var d=xe();Q(()=>te(d,e(a).name)),f(p,d)}}),re()}var Yo=$('<dialog class="svelte-1chcjmg"><article class="svelte-1chcjmg"><!></article> <div class="controls svelte-1chcjmg"><!></div></dialog>');function fe(l,t){oe(t,!0);let a=F(void 0);function p(){e(a)?.showModal()}function c(){e(a)?.close(),t.onDismiss?.()}var d={show:p},h=Yo(),y=v(h),x=v(y);be(x,()=>t.children),s(y);var m=r(y,2),_=v(m);return be(_,()=>t.actions,()=>c),s(m),s(h),N(h,z=>P(a,z),()=>e(a)),f(l,h),re(d)}var Xo=$("<button>Of course!</button>"),No=$(`<p>Hello mayor, and welcome to the location of our new town! All of us are just getting started
    here ourselves. We haven't even placed a single card yet!</p> <p>I have the card for a <!> right here, I'll put it into your deck.
    Since you're in charge here, I'll let you see about setting that up for us. Start by opening up the
    deck view.</p> <p class="info svelte-1195hbs">The button to open the deck view is at the bottom right.</p>`,1),Uo=$("<button>Got it!</button>"),Wo=$(`<p>This is the deck view; the cards you see here are yours. There are all sorts of cards to be
    collected, each one providing a different function. I'm sure you'll soon have a whole collection
    and turn this town into a great place to live!</p> <p>For now, we just need to set up that <!> for your citizens to live
    in.</p> <p class="info svelte-1195hbs">Click a card to drop it into the world.</p>`,1),Lo=$("<button>On it!</button>"),Ho=$(`<p>The <!> is now on the field, but it's sitting loose. Make sure to
    properly set into the grid to ensure that it stays put.</p> <p class="info svelte-1195hbs">Click and drag cards to relocate them.</p>`,1),Zo=$("<button>Got it!</button>"),Jo=$(`<p>Residential cards provide housing for residents in your town. The <!> in particular has room for 6 <!> residents.</p> <p>Each type of resident has different needs. When the needs of a resident are satisfied, their
    productivity increases and they will pay you more <!>.</p> <p>A <!> requires 1 <!> per day to be satisfied. Luckily,
    I have a <!> card already, which will allow us to produce that <!> right here in town!</p> <p class="info svelte-1195hbs">Place a <!> from your deck into your town.</p>`,1),Qo=$("<button>Ok!</button>"),Vo=$(`<p>The <!> is a Production card. Production cards produce resources by consuming
    the resources of other cards nearby. To produce 5 units of <!>, the <!> uses 1 unit of <!> and 4 units of <!>.</p> <p>If we want this <!> working, we'll need to get our hands on those resources.
    I think I have a few more cards that might help with that, take a look and see what you can do.</p>`,1),Ko=$("<button>Makes sense to me!</button>"),er=$(`<p>The <!> and <!> cards are both Source cards, meaning
    they are able to produce resources without needing to consume anything first. Instead, they allow
    you to harvest resources straight from the source.</p> <p>While the <!> is able to produce water from anywhere, the <!> requires being placed on fertile <!> in order to
    grow wheat.</p> <p class="info svelte-1195hbs">Make sure your new cards are both producing.</p>`,1),tr=$("<button>Wow!</button>"),or=$(`<p>The <!> is producing, but without a <!> in town,
    there's nothing for us to do with the <!>.</p> <p>Luckily, I've got one last card here with me, it's a rare <!> card. You'll
    probably never get your hands on another one of these. This <!> will become the backbone of our town, allowing us to sell our excess resources in exchange for <!>.</p> <p class="info svelte-1195hbs">Place the <!>.</p>`,1),rr=$("<button>I do like money...</button>"),ar=$(`<p>This is a world of production and trade, so all resources are reported in a rate of <strong>production per day</strong>. Other than <!>, there's not much point in
    stockpiling any resources. Instead, at the end of each day, any excess resources we haven't used
    get exported via the <!>.</p> <p>The <!> produces 4 <!> per day, but a unit of <!> is worth just <!> when exported. The <!> on the other hand isn't even worth selling. Unused resources aren't worth
    much!</p> <p>Eventually most of your income will be coming from satisfied residents buying the things they
    need, but for now I'll just work out a deal real quick for your first export.</p>`,1),nr=$("<button>Exciting!</button>"),sr=$(`<p>The other thing the <!> allows you to trade for is more cards. For a
    little bit of <!>, you can buy a pack containing a few common cards which you can add
    to your town.</p> <p class="info svelte-1195hbs">Open up the shop with the button at the bottom right.</p>`,1),ir=$("<button>That's ok...</button>"),cr=$(`<p>The shop offers new cards in <strong>Packs</strong>. The available packs are always changing,
    and each one contains a different assortment of cards, so be sure to check back often and buy
    any that catch your eye.</p> <p>There's one pack available right now, the <!>, but I have a
    confession to make... I already opened it and gave you most of the cards. There's still one left
    though, I didn't want to take away all the fun!</p> <p class="info svelte-1195hbs">Buy (the rest of) the <!>.</p>`,1),dr=$("<button>Cool!</button>"),lr=$(`<p>There's just one last step: to set up the transportation of resources from where they are
    produced, to where they will be consumed. As the mayor, you're responsible for determining all
    of what goes where and how it gets there.</p> <p>In general, it's hard to move things long distances by hand in one day. One or two tiles is
    totally fine, but beyond that you'll be losing about 25% of the total throughput per tile. Any
    more than 5 tiles is too far for things to be carried by hand in a day at all, though you might
    be able find cards for useful tools to help with that type of thing later on.</p> <p class="info svelte-1195hbs">Enter Flow mode and drag connections from producers to consumers.</p>`,1),ur=$("<button>I will!</button>"),vr=$(`<p>That's it, the <!> is finally able to make its <!>!
    You don't have to set up connections for residents finding and consuming their needs, or for
    resources to be exported, that all happens automatically, so you'll find that already your
    expected profits for tomorrow are looking quite healthy!</p> <p>You'll be on your own from here on out. I look forward to seeing where you take the town, and
    meeting all the people who will eventually move in! Good luck, and I hope you have fun!</p> <p class="info svelte-1195hbs">Cards don't only come from packs. Earn powerful and rare cards by participating in certain
    activities in the real world, or trade your cards online with other players to get exactly the
    ones you need.</p>`,1),pr=$("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!>",1);function hr(l,t){oe(t,!0);const a=Ie(),p=g(()=>a.deck),c=g(()=>a.field),d=g(()=>a.shop),h=Ke(),y=g(()=>h.resourceProduction);let x=F(void 0),m=F(void 0),_=F(void 0),z=F(void 0),C=F(void 0),T=F(void 0),R=F(void 0),O=F(void 0),M=F(void 0),w=F(void 0),E=F(void 0),k=F(void 0),o=F("intro");lt(()=>{const U=window.localStorage.getItem("tutorial_step");if(!U)return;const i=JSON.parse(U);typeof i=="string"&&P(o,i,!0)}),Xe(()=>{window.localStorage.setItem("tutorial_step",JSON.stringify(e(o))),e(o)==="intro"&&window.setTimeout(()=>e(x).show(),500),e(o)==="buy-pack"&&window.setTimeout(()=>e(M).show(),500)}),Xe(()=>{e(o)==="await-production"&&e(y).wheat&&e(y).wheat.produced>0&&window.setTimeout(()=>e(R).show(),500)}),Xe(()=>{e(o)==="produce-bread"&&e(y).bread&&e(y).bread.produced>0&&(window.setTimeout(()=>e(k).show(),500),P(o,"complete"))});function u(){window.setTimeout(()=>{window.dispatchEvent(new Oe([{id:Me(),type:"cat-neighbourhood"}])),P(o,"place-neighbourhood")},500)}function I(){window.setTimeout(()=>{window.dispatchEvent(new Oe([{id:Me(),type:"bakery"}])),P(o,"place-bakery")},500)}function S(){window.setTimeout(()=>{window.dispatchEvent(new Oe([{id:Me(),type:"water-well"},{id:Me(),type:"wheat-farm"}])),P(o,"place-sources")},500)}function q(){window.setTimeout(()=>{window.dispatchEvent(new Oe([{id:Me(),type:"trading-centre"}])),P(o,"place-trading-centre")},500)}function D(){a.money+=4,P(o,"buy-pack"),e(d).packs.push({id:window.crypto.randomUUID(),name:"Starter Pack?",description:`A one of a kind pack containing all you need to get started!
It looks like this one has been opened already, and some of the cards are missing.`,price:4,originalPrice:20,contents:[{type:"card",card:"cat-neighbourhood",missing:!0},{type:"card",card:"water-well",missing:!0},{type:"card",card:"wheat-farm",missing:!0},{type:"card",card:"flour-mill"},{type:"card",card:"bakery",missing:!0}]})}function X(U){e(o)==="place-neighbourhood"&&window.setTimeout(()=>e(m).show(),500)}function j(U){e(o)==="buy-pack"&&window.setTimeout(()=>e(w).show(),500)}function Z({card:U}){e(o)==="place-neighbourhood"&&U.type==="cat-neighbourhood"&&window.setTimeout(()=>e(_).show(),500)}function W(U){e(o)==="buy-pack"&&P(o,"produce-bread")}function L({card:U}){e(o)==="place-neighbourhood"&&e(p).find(i=>i.id===U.id)?.type==="cat-neighbourhood"&&(window.setTimeout(()=>e(z).show(),500),P(o,"place-bakery")),e(o)==="place-bakery"&&e(p).find(i=>i.id===U.id)?.type==="bakery"&&window.setTimeout(()=>e(C).show(),500),e(o)==="place-sources"&&["wheat-farm","water-well"].every(i=>e(c).some(A=>!A.loose&&e(p).some(n=>A.id===n.id&&n.type===i)))&&window.setTimeout(()=>e(T).show(),500),e(o)==="place-trading-centre"&&e(p).find(i=>i.id===U.id)?.type==="trading-centre"&&window.setTimeout(()=>e(O).show(),500),e(o)==="produce-bread"&&e(p).find(i=>i.id===U.id)?.type==="flour-mill"&&window.setTimeout(()=>e(E).show(),500)}var J=pr();ie("deckopened",ve,X),ie("shopopened",ve,j),ie("cardfielded",ve,Z),ie("cardplaced",ve,L),ie("buypack",ve,W);var V=Y(J);N(fe(V,{onDismiss:u,actions:(i,A=ce)=>{var n=Xo();n.__click=function(...b){A()?.apply(this,b)},f(i,n)},children:(i,A)=>{var n=No(),b=r(Y(n),2),G=r(v(b));K(G,{id:"cat-neighbourhood"}),B(),s(b),B(2),f(i,n)},$$slots:{actions:!0,default:!0}}),i=>P(x,i,!0),()=>e(x));var le=r(V,2);N(fe(le,{actions:(i,A=ce)=>{var n=Uo();n.__click=function(...b){A()?.apply(this,b)},f(i,n)},children:(i,A)=>{var n=Wo(),b=r(Y(n),2),G=r(v(b));K(G,{id:"cat-neighbourhood"}),B(),s(b),B(2),f(i,n)},$$slots:{actions:!0,default:!0}}),i=>P(m,i,!0),()=>e(m));var ge=r(le,2);N(fe(ge,{actions:(i,A=ce)=>{var n=Lo();n.__click=function(...b){A()?.apply(this,b)},f(i,n)},children:(i,A)=>{var n=Ho(),b=Y(n),G=r(v(b));K(G,{id:"cat-neighbourhood"}),B(),s(b),B(2),f(i,n)},$$slots:{actions:!0,default:!0}}),i=>P(_,i,!0),()=>e(_));var ye=r(ge,2);N(fe(ye,{onDismiss:I,actions:(i,A=ce)=>{var n=Zo();n.__click=function(...b){A()?.apply(this,b)},f(i,n)},children:(i,A)=>{var n=Jo(),b=Y(n),G=r(v(b));K(G,{id:"cat-neighbourhood"});var H=r(G,2);rt(H,{id:"cat"}),B(),s(b);var ne=r(b,2),ae=r(v(ne));Ee(ae,{}),B(),s(ne);var se=r(ne,2),ee=r(v(se));rt(ee,{id:"cat"});var he=r(ee,2);ue(he,{id:"bread"});var ke=r(he,2);K(ke,{id:"bakery"});var De=r(ke,2);ue(De,{id:"bread"}),B(),s(se);var Ye=r(se,2),Te=r(v(Ye));K(Te,{id:"bakery"}),B(),s(Ye),f(i,n)},$$slots:{actions:!0,default:!0}}),i=>P(z,i,!0),()=>e(z));var Ce=r(ye,2);N(fe(Ce,{onDismiss:S,actions:(i,A=ce)=>{var n=Qo();n.__click=function(...b){A()?.apply(this,b)},f(i,n)},children:(i,A)=>{var n=Vo(),b=Y(n),G=r(v(b));K(G,{id:"bakery"});var H=r(G,2);ue(H,{id:"bread"});var ne=r(H,2);K(ne,{id:"bakery"});var ae=r(ne,2);ue(ae,{id:"water"});var se=r(ae,2);ue(se,{id:"flour"}),B(),s(b);var ee=r(b,2),he=r(v(ee));K(he,{id:"bakery"}),B(),s(ee),f(i,n)},$$slots:{actions:!0,default:!0}}),i=>P(C,i,!0),()=>e(C));var $e=r(Ce,2);N(fe($e,{onDismiss:()=>P(o,"await-production"),actions:(i,A=ce)=>{var n=Ko();n.__click=function(...b){A()?.apply(this,b)},f(i,n)},children:(i,A)=>{var n=er(),b=Y(n),G=r(v(b));K(G,{id:"water-well"});var H=r(G,2);K(H,{id:"wheat-farm"}),B(),s(b);var ne=r(b,2),ae=r(v(ne));K(ae,{id:"water-well"});var se=r(ae,2);K(se,{id:"wheat-farm"});var ee=r(se,2);xt(ee,{id:"soil"}),B(),s(ne),B(2),f(i,n)},$$slots:{actions:!0,default:!0}}),i=>P(T,i,!0),()=>e(T));var Ae=r($e,2);N(fe(Ae,{onDismiss:q,actions:(i,A=ce)=>{var n=tr();n.__click=function(...b){A()?.apply(this,b)},f(i,n)},children:(i,A)=>{var n=or(),b=Y(n),G=r(v(b));K(G,{id:"wheat-farm"});var H=r(G,2);K(H,{id:"flour-mill"});var ne=r(H,2);ue(ne,{id:"wheat"}),B(),s(b);var ae=r(b,2),se=r(v(ae));K(se,{id:"trading-centre"});var ee=r(se,2);K(ee,{id:"trading-centre"});var he=r(ee,2);Ee(he,{}),B(),s(ae);var ke=r(ae,2),De=r(v(ke));K(De,{id:"trading-centre"}),B(),s(ke),f(i,n)},$$slots:{actions:!0,default:!0}}),i=>P(R,i,!0),()=>e(R));var ze=r(Ae,2);N(fe(ze,{onDismiss:D,actions:(i,A=ce)=>{var n=rr();n.__click=function(...b){A()?.apply(this,b)},f(i,n)},children:(i,A)=>{var n=ar(),b=Y(n),G=r(v(b),3);Ee(G,{});var H=r(G,2);K(H,{id:"trading-centre"}),B(),s(b);var ne=r(b,2),ae=r(v(ne));K(ae,{id:"wheat-farm"});var se=r(ae,2);ue(se,{id:"wheat"});var ee=r(se,2);ue(ee,{id:"wheat"});var he=r(ee,2);Ee(he,{amount:1});var ke=r(he,2);ue(ke,{id:"water"}),B(),s(ne),B(2),f(i,n)},$$slots:{actions:!0,default:!0}}),i=>P(O,i,!0),()=>e(O));var Ge=r(ze,2);N(fe(Ge,{actions:(i,A=ce)=>{var n=nr();n.__click=function(...b){A()?.apply(this,b)},f(i,n)},children:(i,A)=>{var n=sr(),b=Y(n),G=r(v(b));K(G,{id:"trading-centre"});var H=r(G,2);Ee(H,{}),B(),s(b),B(2),f(i,n)},$$slots:{actions:!0,default:!0}}),i=>P(M,i,!0),()=>e(M));var Be=r(Ge,2);N(fe(Be,{actions:(i,A=ce)=>{var n=ir();n.__click=function(...b){A()?.apply(this,b)},f(i,n)},children:(i,A)=>{var n=cr(),b=r(Y(n),2),G=r(v(b));Ne(G,{children:(ae,se)=>{B();var ee=xe("Starter Pack");f(ae,ee)}}),B(),s(b);var H=r(b,2),ne=r(v(H));Ne(ne,{children:(ae,se)=>{B();var ee=xe("Starter Pack");f(ae,ee)}}),B(),s(H),f(i,n)},$$slots:{actions:!0,default:!0}}),i=>P(w,i,!0),()=>e(w));var Re=r(Be,2);N(fe(Re,{actions:(i,A=ce)=>{var n=dr();n.__click=function(...b){A()?.apply(this,b)},f(i,n)},children:(i,A)=>{var n=lr();B(4),f(i,n)},$$slots:{actions:!0,default:!0}}),i=>P(E,i,!0),()=>e(E));var je=r(Re,2);N(fe(je,{actions:(i,A=ce)=>{var n=ur();n.__click=function(...b){A()?.apply(this,b)},f(i,n)},children:(i,A)=>{var n=vr(),b=Y(n),G=r(v(b));K(G,{id:"bakery"});var H=r(G,2);ue(H,{id:"bread"}),B(),s(b),B(4),f(i,n)},$$slots:{actions:!0,default:!0}}),i=>P(k,i,!0),()=>e(k)),f(l,J),re()}Se(["click"]);var fr=$('<main class="svelte-hy9bcf"><!></main> <div class="hud svelte-hy9bcf"><!></div> <!>',1),gr=$('<div role="application" class="svelte-hy9bcf"><!></div>');function Cr(l){var t=gr(),a=v(t);$t(a,{children:(p,c)=>{Dt(p,{children:(d,h)=>{Gt(d,{children:(y,x)=>{var m=fr(),_=Y(m),z=v(_);ao(z,{}),s(_);var C=r(_,2),T=v(C);jo(T,{}),s(C);var R=r(C,2);hr(R,{}),f(y,m)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),s(t),f(l,t)}export{Cr as component};
